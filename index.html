<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>@Opensourced</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-icons-font@v7/font/simple-icons.min.css">
  <script src="app.js"></script>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      background: url('https://wallpapercave.com/wp/wp2757874.gif') center/cover no-repeat;
      font-family: 'Segoe UI', Arial, sans-serif;
      overflow: hidden;
    }
    .stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: repeating-linear-gradient(0deg, transparent, transparent 39px, rgba(255,255,255,0.03) 40px), repeating-linear-gradient(90deg, transparent, transparent 39px, rgba(255,255,255,0.03) 40px);
      pointer-events: none;
      z-index: 1;
    }
    .centerboxes {
      position: absolute;
      left: 55%;
      top: 50%;
      transform: translate(-50%, -55%);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 36px;
      width: 100vw;
      pointer-events: none;
      z-index: 2;
    }
    .skills-card, .projects-card, .profile-card {
      min-height: 420px;
    }
    .skills-card {
      background: linear-gradient(135deg, rgba(44,179,255,0.18) 0%, rgba(0,106,255,0.18) 100%), rgba(20, 28, 40, 0.55);
      border-radius: 24px;
      box-shadow: 0 8px 32px 0 rgba(0,0,0,0.22);
      backdrop-filter: blur(12px);
      padding: 32px 24px;
      min-width: 120px;
      display: flex;
      flex-direction: column;
      align-items: center;
      pointer-events: auto;
      gap: 18px;
    }
    .skills-title {
      color: #fff;
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }
    .skills-logos {
      display: flex;
      flex-direction: column;
      gap: 18px;
      align-items: center;
    }
    .skills-logos i, .skills-logos span {
      font-size: 2.4rem;
      margin: 0 0.2em;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .skills-logos .si-python { color: #3776AB; }
    .skills-logos .si-html5 { color: #E34F26; }
    .skills-logos .si-css3 { color: #1572B6; }
    .skills-logos .si-javascript { color: #F7DF1E; }
    .skills-logos .si-react { color: #61DAFB; }
    .profile-card {
      width: 420px;
      background: linear-gradient(135deg, rgba(255,179,44,0.18) 0%, rgba(255,106,0,0.18) 100%), rgba(20, 28, 40, 0.55);
      border-radius: 32px;
      box-shadow: 0 8px 32px 0 rgba(0,0,0,0.37);
      backdrop-filter: blur(16px);
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 48px 0 32px 0;
      z-index: 2;
      pointer-events: auto;
      min-width: 340px;
      max-width: 98vw;
    }
    .profile-avatar {
      width: 110px;
      height: 110px;
      border-radius: 50%;
      object-fit: cover;
      border: 4px solid rgba(255,255,255,0.18);
      margin-bottom: 18px;
      box-shadow: 0 2px 16px 0 rgba(0,0,0,0.25);
    }
    .profile-name {
      background: linear-gradient(90deg, #ffb32c 0%, #ff6a00 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
      font-size: 2.3rem;
      font-weight: 700;
      margin-bottom: 8px;
      letter-spacing: 1px;
    }
    .profile-status-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .profile-status {
      color: #fff;
      font-size: 1.1rem;
      font-weight: 500;
      opacity: 0.85;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .status-dot {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 2px;
      border: 2.5px solid #181a20;
      box-sizing: border-box;
    }
    .status-online { background: #43b581; }
    .status-idle { background: #faa61a; }
    .status-dnd { background: #f04747; }
    .status-offline { background: #747f8d; }
    .status-invisible { background: #747f8d; }
    .status-coding { background: #61dafb; }
    .status-gaming { background: #5865f2; }
    .profile-links {
      display: flex;
      gap: 28px;
      margin-bottom: 10px;
    }
    .profile-links a {
      color: #fff;
      font-size: 2rem;
      transition: transform 0.2s, color 0.2s;
      filter: drop-shadow(0 2px 8px #0008);
    }
    .profile-links a:hover {
      color: #ffb32c;
      transform: scale(1.15) rotate(-8deg);
    }
    .profile-views {
      color: #fff;
      font-size: 1rem;
      opacity: 0.7;
      margin-top: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
      align-self: flex-start;
      margin-left: 32px;
      user-select: none;
    }
    .projects-card {
      background: linear-gradient(135deg, rgba(44,255,179,0.18) 0%, rgba(0,255,106,0.18) 100%), rgba(20, 28, 40, 0.55);
      border-radius: 24px;
      box-shadow: 0 8px 32px 0 rgba(0,0,0,0.22);
      backdrop-filter: blur(12px);
      padding: 32px 24px;
      min-width: 220px;
      display: flex;
      flex-direction: column;
      align-items: center;
      pointer-events: auto;
      gap: 18px;
    }
    .projects-title {
      color: #fff;
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 10px;
      letter-spacing: 1px;
    }
    .project-list {
      display: flex;
      flex-direction: column;
      gap: 18px;
      width: 100%;
    }
    .project-box {
      background: rgba(30,40,60,0.7);
      border-radius: 16px;
      padding: 16px 14px;
      display: flex;
      align-items: center;
      gap: 16px;
      cursor: pointer;
      transition: background 0.2s, transform 0.2s;
      box-shadow: 0 2px 8px 0 rgba(0,0,0,0.12);
    }
    .project-box:hover {
      background: rgba(44,255,179,0.18);
      transform: scale(1.03);
    }
    .project-logo {
      font-size: 2.2rem;
      width: 44px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      background: #222c3a;
      overflow: hidden;
    }
    .project-logo img {
      width: 32px;
      height: 32px;
      object-fit: contain;
      display: block;
    }
    .project-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }
    .project-name {
      color: #fff;
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 2px;
    }
    .project-desc {
      color: #b6eada;
      font-size: 0.98rem;
      opacity: 0.85;
      font-weight: 400;
    }
    .music-player {
      position: fixed;
      left: 50%;
      bottom: 40px;
      transform: translateX(-50%);
      width: 480px;
      background: linear-gradient(90deg, rgba(255,179,44,0.13) 0%, rgba(255,106,0,0.13) 100%), rgba(20, 28, 40, 0.65);
      border-radius: 20px;
      box-shadow: 0 8px 32px 0 rgba(0,0,0,0.37);
      backdrop-filter: blur(12px);
      display: flex;
      align-items: center;
      padding: 18px 28px;
      z-index: 3;
      gap: 18px;
      min-height: 80px;
      pointer-events: auto;
    }
    .music-cover {
      width: 54px;
      height: 54px;
      border-radius: 12px;
      object-fit: cover;
      align-self: center;
      margin-left: -2px;
      box-shadow: 0 2px 12px 0 rgba(0,0,0,0.25);
      background: #222c3a;
      display: block;
    }
    .music-info {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .music-title {
      color: #fff;
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 6px;
      opacity: 0.92;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      max-width: 220px;
    }
    .music-progress {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .music-time {
      color: #fff;
      font-size: 0.95rem;
      opacity: 0.7;
      min-width: 36px;
      text-align: center;
    }
    .music-bar-bg {
      flex: 1;
      height: 4px;
      background: #222c3a;
      border-radius: 2px;
      overflow: hidden;
      margin: 0 4px;
    }
    .music-bar {
      height: 100%;
      background: linear-gradient(90deg, #ffb32c 0%, #ff6a00 100%);
      width: 0%;
      border-radius: 2px;
      transition: width 0.3s;
    }
    .music-controls {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-left: 10px;
    }
    .music-controls i {
      color: #fff;
      font-size: 1.3rem;
      cursor: pointer;
      opacity: 0.9;
      transition: color 0.2s, transform 0.2s;
    }
    .music-controls i:hover {
      color: #ffb32c;
      transform: scale(1.15);
    }
    .custom-status-bar {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      gap: 18px;
    }

    .custom-status-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .custom-status-text {
      display: flex;
      align-items: center;
      height: 48px;
    }
    @media (max-width: 1100px) {
      .centerboxes {
        flex-direction: column;
        gap: 18px;
        transform: translate(-50%, -50%);
        margin-right: 3in;
      }
      .skills-card, .projects-card {
        min-width: 0;
        width: 90vw;
        max-width: 98vw;
      }
    }
    @media (max-width: 600px) {
      .profile-card, .music-player {
        width: 95vw;
        min-width: 0;
        max-width: 98vw;
        padding-left: 0;
        padding-right: 0;
      }
      .music-player {
        width: 96vw;
        min-width: 0;
        max-width: 99vw;
        padding: 12px 6px;
        left: 50%;
        bottom: 16px;
        transform: translateX(-50%);
      }
      .music-title {
        max-width: 80px;
        font-size: 0.98rem;
      }
      .music-cover {
        width: 40px;
        height: 40px;
        margin-right: 8px;
      }
      .music-controls i {
        font-size: 1.1rem;
        margin-left: 2px;
        margin-right: 2px;
      }
    }
  </style>
</head>
<body>
  <div class="stars"></div>
  <div class="centerboxes">
    <div class="skills-card">
      <div class="skills-title">Skills</div>
      <div class="skills-logos">
        <span class="si si-python"></span>
        <span class="si si-html5"></span>
        <span class="si si-css3"></span>
        <span class="si si-javascript"></span>
        <span class="si si-react"></span>
        <span class="si si-cplusplus"></span>
      </div>
    </div>
    <div class="profile-card">
      <img class="profile-avatar" id="profile-avatar" src="https://cdn.discordapp.com/avatars/1302298138995982397/1a4e26fbf7786d66bed6224af0e838f8?size=1024" alt="avatar">
      <div class="profile-name">opensourced</div>
      <div class="profile-status-row">
        <span id="status-dot" class="status-dot status-offline"></span>
        <span class="profile-status" id="profile-status">Loading status...</span>
      </div>
      <div class="profile-links">
        <a href="#"><i class="fa-brands fa-discord"></i></a>
        <a href="#"><i class="fa-brands fa-roblox"></i></a>
        <a href="#"><i class="fa-brands fa-spotify"></i></a>
      </div>
      <div class="profile-views" id="profile-views"><i class="fa-regular fa-eye"></i> <span id="view-count">0</span></div>
    </div>
    <div class="projects-card">
      <div class="projects-title">Projects</div>
      <div class="project-list">
        <div class="project-box" onclick="window.open('https://discord.gg/vyper', '_blank')">
          <div class="project-logo"><img src="vyper.png" alt="Vyper"></div>
          <div class="project-info">
            <div class="project-name">Vyper</div>
            <div class="project-desc">A proxy development service</div>
          </div>
        </div>
        <div class="project-box" onclick="window.open('https://discord.gg/texerum', '_blank')">
          <div class="project-logo"><img src="Texerum.png" alt="Texerm"></div>
          <div class="project-info">
            <div class="project-name">Texerm</div>
            <div class="project-desc">An unblocker with a clean and minimal UI</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="music-player" id="music-player">
    <img class="music-cover" id="music-cover" src="" alt="cover">
    <div class="music-info" id="music-info">
      <div class="music-title" id="music-title">Loading...</div>
      <div class="music-progress" id="music-progress">
        <span class="music-time" id="music-current">0:00</span>
        <div class="music-bar-bg">
          <div class="music-bar" id="music-bar"></div>
        </div>
        <span class="music-time" id="music-duration">0:00</span>
      </div>
      <div class="music-activity" id="music-activity"></div>
    </div>
    <div class="music-controls" id="music-controls">
      <i class="fa-solid fa-backward" id="music-prev"></i>
      <i class="fa-solid fa-play" id="music-play"></i>
      <i class="fa-solid fa-forward" id="music-next"></i>
    </div>
    <audio id="audio-player" style="display:none;"></audio>
  </div>
  <script>
    const DISCORD_ID = "1302298138995982397";
    const musicCover = document.getElementById('music-cover');
    const musicTitle = document.getElementById('music-title');
    const musicCurrent = document.getElementById('music-current');
    const musicDuration = document.getElementById('music-duration');
    const musicBar = document.getElementById('music-bar');
    const musicControls = document.getElementById('music-controls');
    const audioPlayer = document.getElementById('audio-player');
    const musicPlayer = document.getElementById('music-player');
    const statusDot = document.getElementById('status-dot');
    const profileStatus = document.getElementById('profile-status');
    const profileAvatar = document.getElementById('profile-avatar');
    const viewCountSpan = document.getElementById('view-count');
    const musicActivity = document.getElementById('music-activity');
    let previewUrl = "";
    let songDuration = 0;
    let songStart = 0;
    let playing = false;
    let lanyardSocket = null;
    let spotifyActive = false;

    function msToTime(ms) {
      const totalSeconds = Math.floor(ms / 1000);
      const minutes = Math.floor(totalSeconds / 60);
      const seconds = totalSeconds % 60;
      return `${minutes}:${seconds.toString().padStart(2, '0')}`;
    }

    function setMusicUI({ cover, title, artist, duration, progress, url, preview_url }) {
      musicCover.src = cover;
      musicTitle.innerHTML = title + (artist ? ` — ${artist}` : "");
      musicDuration.textContent = msToTime(duration);
      musicBar.style.width = `${(progress / duration) * 100}%`;
      previewUrl = preview_url;
      songDuration = duration;
      songStart = Date.now() - progress;
      if (preview_url) {
        audioPlayer.src = preview_url;
        audioPlayer.currentTime = Math.min(progress / 1000, 30);
        musicControls.style.display = "flex";
        musicControls.querySelector("#music-play").className = "fa-solid fa-pause";
        playing = true;
        audioPlayer.play();
        requestAnimationFrame(updateMusicTime);
      } else {
        audioPlayer.pause();
        audioPlayer.src = "";
        musicControls.style.display = "none";
        musicTitle.innerHTML += ` <a href="${url}" target="_blank" style="color:#1db954;text-decoration:none;">Open in Spotify</a>`;
        musicCurrent.textContent = msToTime(progress);
      }
    }

    function setActivityUI({ cover, name, details, type }) {
      musicCover.src = cover;
      musicTitle.textContent = name + (details ? ` — ${details}` : "");
      musicCurrent.textContent = "";
      musicDuration.textContent = "";
      musicBar.style.width = "0%";
      musicControls.style.display = "none";
      audioPlayer.pause();
      audioPlayer.src = "";
    }

    function updateMusicTime() {
      if (!spotifyActive) return;
      let elapsed = Date.now() - songStart;
      if (previewUrl) {
        if (elapsed > 30000) elapsed = 30000;
        audioPlayer.currentTime = Math.min(elapsed / 1000, 30);
      }
      if (elapsed > songDuration) elapsed = songDuration;
      musicCurrent.textContent = msToTime(elapsed);
      musicBar.style.width = `${(elapsed / songDuration) * 100}%`;
      if (playing && elapsed < songDuration) {
        requestAnimationFrame(updateMusicTime);
      }
    }

    async function getSpotifyPreview(track_id) {
      try {
        const metaRes = await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent("https://open.spotify.com/oembed?url=https://open.spotify.com/track/" + track_id)}`);
        const metaData = await metaRes.json();
        const html = metaData.contents;
        const match = html.match(/"audioPreviewUrl":"(.*?)"/);
        if (match) return JSON.parse('"' + match[1] + '"');
      } catch {}
      return "";
    }

    function getStatusIcon(status, activities) {
      if (activities && activities.some(a => a.name && a.name.toLowerCase().includes("vscode"))) return "status-coding";
      if (activities && activities.some(a => a.type === 0 && a.name && a.name.toLowerCase().includes("code"))) return "status-coding";
      if (activities && activities.some(a => a.type === 0 && a.name && a.name.toLowerCase().includes("game"))) return "status-gaming";
      if (activities && activities.some(a => a.type === 0 && a.name && a.name.toLowerCase().includes("playing"))) return "status-gaming";
      if (status === "online") return "status-online";
      if (status === "idle") return "status-idle";
      if (status === "dnd") return "status-dnd";
      if (status === "invisible" || status === "offline") return "status-offline";
      return "status-offline";
    }

    function getStatusText(status, activities) {
      if (activities && activities.some(a => a.name && a.name.toLowerCase().includes("vscode"))) return "Coding";
      if (activities && activities.some(a => a.type === 0 && a.name && a.name.toLowerCase().includes("code"))) return "Coding";
      if (activities && activities.some(a => a.type === 0 && a.name && a.name.toLowerCase().includes("game"))) return "Gaming";
      if (activities && activities.some(a => a.type === 0 && a.name && a.name.toLowerCase().includes("playing"))) return "Gaming";
      if (status === "online") return "Online";
      if (status === "idle") return "Idle";
      if (status === "dnd") return "Do Not Disturb";
      if (status === "invisible" || status === "offline") return "Offline";
      return "Offline";
    }

    function getMusicActivityText(status, activities) {
      if (activities && activities.some(a => a.name && a.name.toLowerCase().includes("vscode"))) return '<i class="fa-solid fa-code"></i> Coding';
      if (activities && activities.some(a => a.type === 0 && a.name && a.name.toLowerCase().includes("code"))) return '<i class="fa-solid fa-code"></i> Coding';
      if (activities && activities.some(a => a.type === 0 && a.name && a.name.toLowerCase().includes("game"))) return '<i class="fa-solid fa-gamepad"></i> Gaming';
      if (activities && activities.some(a => a.type === 0 && a.name && a.name.toLowerCase().includes("playing"))) return '<i class="fa-solid fa-gamepad"></i> Gaming';
      if (status === "online") return '<span style="color:#43b581"><i class="fa-solid fa-circle"></i></span> Online';
      if (status === "idle") return '<span style="color:#faa61a"><i class="fa-solid fa-circle"></i></span> Idle';
      if (status === "dnd") return '<span style="color:#f04747"><i class="fa-solid fa-minus-circle"></i></span> Do Not Disturb';
      if (status === "invisible" || status === "offline") return '<span style="color:#747f8d"><i class="fa-solid fa-circle"></i></span> Offline';
      return '<span style="color:#747f8d"><i class="fa-solid fa-circle"></i></span> Offline';
    }

    async function handleLanyardData(d) {
      if (d.listening_to_spotify && d.spotify) {
        spotifyActive = true;
        const s = d.spotify;
        let preview_url = await getSpotifyPreview(s.track_id);
        setMusicUI({
          cover: s.album_art_url,
          title: s.song,
          artist: s.artist,
          duration: s.duration_ms,
          progress: s.timestamps.start ? Date.now() - s.timestamps.start : 0,
          url: s.track_url,
          preview_url
        });
        musicPlayer.onclick = () => window.open(s.track_url, "_blank");
        musicActivity.innerHTML = getMusicActivityText(d.discord_status, d.activities);
      } else if (d.activities && d.activities.length > 0) {
        spotifyActive = false;
        const act = d.activities.find(a => a.type === 0 || a.type === 1 || a.type === 2 || a.type === 4) || d.activities[0];
        let cover = act.assets && act.assets.large_image ? 
          (act.assets.large_image.startsWith("mp:external") ? 
            "https://media.discordapp.net/" + act.assets.large_image.replace("mp:external/", "") : 
            `https://cdn.discordapp.com/app-assets/${act.application_id}/${act.assets.large_image}.png`) : 
          "https://cdn.discordapp.com/embed/avatars/0.png";
        setActivityUI({
          cover,
          name: act.name,
          details: act.details || act.state || "",
          type: act.type
        });
        musicPlayer.onclick = null;
        musicActivity.innerHTML = getMusicActivityText(d.discord_status, d.activities);
      } else {
        spotifyActive = false;
        setActivityUI({
          cover: "https://cdn.discordapp.com/embed/avatars/0.png",
          name: "Nothing playing"
        });
        musicPlayer.onclick = null;
        musicActivity.innerHTML = getMusicActivityText(d.discord_status, d.activities);
      }
      const statusClass = getStatusIcon(d.discord_status, d.activities);
      statusDot.className = "status-dot " + statusClass;
      profileStatus.textContent = getStatusText(d.discord_status, d.activities);
      if (d.discord_user && d.discord_user.avatar) {
        profileAvatar.src = `https://cdn.discordapp.com/avatars/${DISCORD_ID}/${d.discord_user.avatar}.png?size=1024`;
      }
    }

    function connectLanyardWS() {
      if (lanyardSocket) lanyardSocket.close();
      lanyardSocket = new WebSocket("wss://api.lanyard.rest/socket");
      lanyardSocket.onopen = () => {
        lanyardSocket.send(JSON.stringify({ op: 2, d: { subscribe_to_id: DISCORD_ID } }));
      };
      lanyardSocket.onmessage = async (event) => {
        const msg = JSON.parse(event.data);
        if (msg.t === "INIT_STATE" || msg.t === "PRESENCE_UPDATE") {
          await handleLanyardData(msg.d);
        }
      };
      lanyardSocket.onclose = () => {
        setTimeout(connectLanyardWS, 2000);
      };
    }

    musicControls.querySelector("#music-play").onclick = () => {
      if (!previewUrl) return;
      if (playing) {
        audioPlayer.pause();
        musicControls.querySelector("#music-play").className = "fa-solid fa-play";
        playing = false;
      } else {
        audioPlayer.play();
        musicControls.querySelector("#music-play").className = "fa-solid fa-pause";
        playing = true;
        requestAnimationFrame(updateMusicTime);
      }
    };

    audioPlayer.ontimeupdate = () => {
      if (!songDuration) return;
      let elapsed = audioPlayer.currentTime * 1000;
      if (elapsed > songDuration) elapsed = songDuration;
      musicCurrent.textContent = msToTime(elapsed);
      musicBar.style.width = `${(elapsed / songDuration) * 100}%`;
    };

    connectLanyardWS();

    async function updateViewCount() {
      const key = "opensourced-portfolio-views";
      let count = localStorage.getItem(key);
      if (!count) count = 0;
      count = parseInt(count, 10) + 1;
      localStorage.setItem(key, count);
      viewCountSpan.textContent = count;
      try {
        const resp = await fetch("https://api.countapi.xyz/hit/opensourced-portfolio/visits");
        const data = await resp.json();
        viewCountSpan.textContent = data.value;
      } catch {
        // fallback to localStorage
      }
    }
    updateViewCount();
  </script>
</body>
</html>